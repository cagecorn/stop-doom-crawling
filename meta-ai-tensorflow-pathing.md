# Meta AI TensorFlow Pathing Guide

이 문서는 `MetaAIManager`가 보다 자연스러운 경로를 계산하도록 텐서플로우(TensorFlow)
모델을 활용하는 방법을 설명합니다. 기존 BFS 방식의 `PathfindingManager`에 머신러닝
모델을 결합하여, 모든 유닛이 로봇처럼 일직선으로만 움직이지 않고 상황에 맞게 유연한
동선을 선택하도록 개선하는 것이 목적입니다.

## 1. 데이터 수집

1. **이동 샘플 기록**: 플레이 테스트 중 `movementManager`가 실행한 실제 경로를
   `DataRecorder`로 수집합니다. 플레이어 조작과 AI 결정이 뒤섞인 데이터를 얻으면
   모델이 "인간적인" 패턴을 학습하는 데 도움이 됩니다.
2. **라벨 구조**: 하나의 샘플은 `[startX, startY, endX, endY]` 입력과 `[{x, y}, ...]`
   형태의 경로 배열 출력으로 구성합니다. 불필요하게 멀리 돌아가거나 벽에 멈춰선
   기록은 제외해 품질을 높입니다.

## 2. 모델 설계

- 텐서플로우의 `tfjs`를 이용해 간단한 다층 퍼셉트론(MLP)을 만듭니다.
- 입력은 `startX, startY, endX, endY` 네 값을 정규화한 후 사용합니다.
- 출력층은 `(경로 길이) × 2` 노드를 가지며, 각 좌표를 순서대로 예측하도록 합니다.
- 학습이 충분히 진행되면 `assets/pathfinding-model.json`으로 저장합니다.

## 3. 게임 내 통합

1. `PathfindingManager.findPathTensor()`가 위 모델을 로드해 경로 예측을 시도합니다.
   실패하면 기존 BFS 로직으로 자동 폴백되므로 안정성이 보장됩니다.
2. `MetaAIManager`는 용병과 몬스터 모두에게 `findPathTensor()` 결과를 우선적으로
   사용하도록 수정합니다. 단, 무조건 모델의 결과만 따라가면 움직임이 부자연스러울
   수 있으니, 예측된 경로에 약간의 난수를 섞거나 도중 재평가하는 로직을 추가하면
   "로봇같지 않은" 자연스러움을 얻을 수 있습니다.

## 4. 추천 학습 전략

- **다양한 맵에서 수집**: 직선 통로뿐 아니라 복잡한 방 구조에서 데이터를 모아야
  모델이 지형에 잘 적응합니다.
- **부분 경로 학습**: 긴 경로를 한 번에 예측하기보다, 목표 지점까지 몇 타일씩
  끊어서 예측하도록 학습하면 안정적인 결과를 얻습니다.
- **정기적인 미세 조정**: 신규 몬스터나 함정이 추가되면 데이터를 다시 수집해
  모델을 업데이트합니다.

TensorFlow 기반 경로 탐색을 활용하면 AI가 목적지까지 단순히 직선으로 이동하는 대신
환경에 맞게 우회하거나 속도를 조절하는 등 한층 더 자연스러운 행동을 보여 줄 수
있습니다.
